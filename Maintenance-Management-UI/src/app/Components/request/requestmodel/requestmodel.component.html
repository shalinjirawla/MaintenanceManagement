<!-- Modal for Creating Request -->
<div class="modal-overlay" tabindex="-1" [ngClass]="{ show: true }">
  <div class="modal-dialog"  *ngIf="!isQuotation">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
        Create New Request
        </h5>
        <button type="button" class="btn-close col-1" (click)="closeModal()">
          <span>&times;</span>
        </button>
      </div>
      <form *ngIf="!isQuotation"  (ngSubmit)="onSubmit()" #requestForm="ngForm"  novalidate>
        <div class="modal-body">
          <div class="formdiv">
            <!-- Main content column -->
            <div class="form-group">
              <label for="title" class="form-label">Title<span class="text-danger">*</span></label>
              <input
                type="text"
                id="title"
                name="title"
                placeholder="Enter Title"
                #title="ngModel"
                class="form-control"
                [(ngModel)]="workorder.title"
                required
              />
              <div *ngIf="title.invalid && title.touched" class="text-danger">
                <small *ngIf="title.errors && title.errors['required']">Title is required.</small>
              </div>
            </div>
            <div class="form-group">
              <label for="description" class="form-label"
                >Description<span class="text-danger">*</span></label
              >
              <input
                type="text"
                id="description"
                name="description"
                placeholder="Enter Description"
                class="form-control"
                [(ngModel)]="workorder.description"
                #description="ngModel"
                required
                minlength="10"
              />
              <div *ngIf="description.invalid && description.touched" class="text-danger">
                <small *ngIf="description.errors && description.errors['required']">
                  Description is required.
                </small>
                <small *ngIf="description.errors && description.errors['minlength']">
                  Description must be at least 10 characters long.
                </small>
              </div>
            </div>
            <div class="form-group">
              <label for="location" class="form-label">Location<span class="text-danger">*</span></label>                                   
              <select id="location"  name="location" #locationModel="ngModel" required class="form-control" [(ngModel)]="workorder.location" required>
                  <option [ngValue]="0" >Select Location</option>
                  <option *ngFor="let location of location" [ngValue]="location.id">{{location.description}}</option>
              </select>
              <div *ngIf="locationModel.invalid && locationModel.touched" class="text-danger">
                  <small *ngIf="locationModel.errors?.['required']">Location is required.</small>
              </div>
          </div>
            <div class="form-group">
              <label for="priority" class="form-label"
                >Priority<span class="text-danger">*</span></label
              >
              <select
                id="priority"
                name="priority"
                class="form-control"
                [(ngModel)]="workorder.priority"
                required
                #priority="ngModel"
              >
              <option [ngValue]="''">Select Priority</option> 
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
              </select>
               <!-- Validation Messages -->
               <div *ngIf="priority.invalid && priority.touched" class="text-danger">
                <small *ngIf="priority.errors && priority.errors['required']">
                  Priority is required.
                </small>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Image<span class="text-danger">*</span></label>
              <input
                type="file"
                id="image"
                name="image"
                class="form-control"
                [(ngModel)]="workorder.image"
                (change)="onFileSelected($event)"
                required
                #image="ngModel"
              />
               <!-- Validation Messages -->
        <div *ngIf="!selectedFile && requestForm.submitted" class="text-danger">
          <small>Image is required.</small>
        </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-sm btn-danger"
            (click)="closeModal()"
          >
            Cancel
          </button>
          <button type="submit" class="btn btn-sm btn-success" [disabled]="requestForm.invalid">
            Submit Request
          </button>
        </div>
      </form>
    </div>
  </div>

<div class="modal-dialog2" *ngIf="isQuotation">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">
        Service Estimate
      </h5>
      <button type="button" class="btn-close col-1" (click)="closeModal()">
        <span>&times;</span>
      </button>
      </div>
        <div class="modal-body">
          <!-- Quotation details with bold labels -->
          <div class="mb-3">
            <div class="card-body">
              <div class="row mb-3">
                <div class="col-md-6">
                  <p><strong>Estimated Cost:</strong></p>
                </div>
                <div class="col-md-6">
                  <p>
                    {{
                      quotation.estimatedCost
                        | currency : "INR" : "symbol" : "1.0-0"
                    }}
                  </p>
                  <!-- Display the extracted cost -->
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-6">
                  <p><strong>Estimated Time:</strong></p>
                </div>
                <div class="col-md-6">
                  <p>{{ quotation.time }}</p>
                  <!-- Display the extracted time -->
                </div>
              </div>
            </div>
          </div>
          <p class="d-none">{{ requestid }}</p>
          <!-- Action Buttons -->
        </div>
        <div class="modal-footer justify-content-center">
          <button
            class="btn btn-success btn-sm me-2"
            (click)="acceptQuotation(requestid)"
            *ngIf="item.status === 1"
          >
            Accept
          </button>
          <button class="btn btn-danger btn-sm" (click)="closeModal()">
            Cancel
          </button>
        </div>
    </div>
  </div>
</div>
